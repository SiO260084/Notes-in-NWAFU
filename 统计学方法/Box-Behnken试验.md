# Box-Behnken 试验概述

Box-Behnken 设计（BBD）是一类响应曲面设计，用于在多因素条件下高效拟合二次模型、探索曲面弯曲并优化响应。它以较少的试验点估计主效应、交互作用和二次项，每个因素设置为三个水平（低、中心、高），并避免所有因素同时处于极端水平的试验组合，从而降低运行成本与风险。与中心复合设计（CCD）相比，BBD通常试验点更少、没有“轴点”（极端水平），但同样可用于构建二次响应面模型并寻找最优条件。

# 为什么要做 Box-Behnken 试验

- **效率与成本：** 在给定因素数的条件下，BBD需要的试验点通常少于CCD，能以更低的成本获得可靠的二次模型估计。
- **安全与可操作性：** BBD不包含所有因素同时取极端水平的试验路径，适合高风险或不宜在边界条件运行的工艺场景。
- **模型能力：** 可有效估计一阶（主效应）、二阶（平方项）及两两交互项，适用于存在曲面的系统优化与响应区域映射。
- **近似旋转性：** 试验区一般为球形，具有近似旋转性，有助于在设计中心周围获得均匀预测精度。

# Box-Behnken 的原理

- **二次模型构建：** 响应曲面从因素设计模型扩展，加入平方项以捕捉弯曲：

  \[
  y = \beta_0 + \sum_{i=1}^{k}\beta_i x_i + \sum_{i<j}\beta_{ij} x_i x_j + \sum_{i=1}^{k}\beta_{ii} x_i^2 + \varepsilon
  \]

  通过在三个水平上布点，BBD能够稳定估计所有上述系数。

- **布点策略：** 将试验点安排在各因子两两组合的“中点面”上，并配合若干中心点重复，既覆盖交互作用，又为纯误差与缺拟合检验提供依据。
- **避开极端组合：** 设计中不出现“所有因素同时在最低或最高水平”的轨迹，以提高运行安全性与可行性。
- **试验次数公式：** 通用试验数为

  \[
  N = 2k(k-1) + C_p
  \]

  其中 \(k\) 为因素数，\(C_p\) 为中心点重复次数；例如 \(k=3\) 时常见为 \(2\times3\times2 + C_p = 12 + C_p\)。

# 如何设计一个 Box-Behnken 试验

- **明确目标与因素：**
  **目的：** 优化目标响应（如产率、强度、误差）。
  **因素选择：** 先用筛选或因子设计识别关键因素，再进入响应曲面阶段。
- **设定水平与范围：**
  **水平数：** 每个因素设三水平（低、中、高）。
  **范围原则：** 覆盖可能的最优区，同时避免不安全的极端条件；BBD不含轴点，有利于在可操作范围内试验。
- **确定试验数：**
  **公式：**
  \[
  N = 2k(k-1) + C_p
  \]
  **中心点：** 建议设置多个中心点（如3次）以估计纯误差并检测缺拟合。
- **随机化与阻断：**
  **随机化：** 随机运行顺序以降低系统性偏差。
  **阻断：** 若存在分批执行或环境变化，使用阻断因子控制批次效应。
- **示例提示：** 实务中，3因素BBD常配置12个边点+若干中心点；4因素为24个边点+中心点，试验区呈球形并具有近似旋转性。

# 如何分析 Box-Behnken 试验的结果

- **拟合与显著性：**
  **模型拟合：** 拟合二次模型（主效应、交互项、平方项）。
  **方差分析（ANOVA）：** 检验整体模型与各项系数的显著性，关注P值、F值、R²、调整R²与预测R²。
  **缺拟合与纯误差：** 依赖中心点重复估计纯误差，进行缺拟合检验，评估模型形式是否充分。
- **诊断与稳健性：**
  **残差分析：** 检查正态性、同方差性与异常值。
  **多重共线：** 评估VIF，避免过强相关导致估计不稳。
- **响应面与等高线：**
  **可视化：** 绘制3D响应面与等高线，理解因素交互与弯曲区域。
- **优化与验证：**
  **多目标优化：** 通过期望度函数或约束优化选择最优设定。
  **确认试验：** 在最优附近进行验证，比较预测与实测，必要时微调因素水平。

# Box-Behnken 与中心复合设计对比

| 特性 | Box-Behnken 设计 | 中心复合设计 |
| --- | --- | --- |
| 试验点数量 | 同因素数下更少、成本更低 | 通常更多 |
| 水平数 | 每因素固定3个水平 | 可达5个水平（含轴点） |
| 极端点 | 避免所有因素极端组合 | 包含轴点，可能涉及极端条件 |
| 适用场景 | 安全边界明确、成本敏感、需二次模型 | 需更灵活的范围与旋转性控制、顺序加点 |

# 实务提示与常见陷阱

- **因素与范围选择至关重要：** 若范围过窄，难以识别弯曲；过宽则可能引入不可控非线性或安全风险。
- **中心点不足会削弱可靠性：** 中心点过少会限制纯误差估计与缺拟合检验的能力；建议至少2–3次重复。
- **旋转性与预测一致性：** BBD具有近似旋转性，但并非严格旋转；在远离中心区域的预测需谨慎。
- **流程化工具支持：** 统计软件提供BBD创建、运行与分析流程（建模、ANOVA、图形与优化），可规范化执行并减少人为偏差。
