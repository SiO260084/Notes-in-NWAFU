# 什么是Plackett-Burman？

**Plackett-Burman设计**是一种高效的**两水平部分因子试验设计**，其主要目的是为了**筛选影响系统的关键因素**。

可以把它想象成一个“初步海选”阶段：

* **场景**：您有10多个可能影响结果（响应变量）的因素（原料配比、温度、压力、时间等）。
* **问题**：如果对每个因素的所有水平组合都进行试验（即全因子试验），试验次数会爆炸式增长（例如，11个因素需要 2^11^ = 2048 次试验！），这在实际中几乎无法实现。
* **解决方案**：Plackett-Burman设计通过一种特殊的矩阵，用最少的试验次数（N=4, 8, 12, 16, 20, ...），来评估大量因素（最多可达 N-1 个）的主效应。

**核心价值**：**以最小的成本，快速从众多潜在因素中识别出少数几个真正重要的因素**，为后续的优化试验（如响应面法）打下基础。

# 如何设计一个Plackett-Burman试验？

设计一个PB试验通常遵循以下步骤，我们用一个例子来说明：

**假设**：我们想优化一个化学反应的产率（响应变量），有7个潜在影响因素（A, B, C, D, E, F, G），每个因素取两个水平（高：+1，低：-1）。

**步骤 1：确定试验次数 (N)**

PB设计的试验次数必须是4的倍数（如 4, 8, 12, 16...）。我们需要评估的因素数量是 k=7。一个基本规则是 **N > k+1**（这里 7+1=8）。因此，我们能选择的最接近8的4的倍数是 **N=12**。
这意味着，我们用12次试验，就可以研究最多11个因素的主效应。我们现在只研究7个，所以有4个是“空列”，可用于估计误差。

**步骤 2：选择标准设计表**

PB设计有现成的标准矩阵表。对于N=12，k=7的情况，我们可以找到一个12行（试验次数）、11列（最多因素数量）的矩阵。我们只需要使用其中的前7列来安排我们的7个因素。

一个经典的N=12的PB设计矩阵前几行如下（+1代表高水平，-1代表低水平）：

| 试验号 | A | B | C | D | E | F | G | ...（空列） |
| :--- | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: |
| 1 | +1 | +1 | -1 | +1 | +1 | +1 | -1 | ... |
| 2 | -1 | +1 | +1 | -1 | +1 | +1 | +1 | ... |
| 3 | +1 | -1 | +1 | +1 | -1 | +1 | +1 | ... |
| 4 | -1 | +1 | -1 | +1 | +1 | -1 | +1 | ... |
| 5 | -1 | -1 | +1 | -1 | +1 | +1 | -1 | ... |
| 6 | -1 | -1 | -1 | +1 | -1 | +1 | +1 | ... |
| ... | ... | ... | ... | ... | ... | ... | ... | ... |
| 12 | -1 | -1 | -1 | -1 | -1 | -1 | -1 | ... |

**步骤 3：随机化运行顺序**

将12次试验的运行顺序完全打乱，而不是按照试验号1-12的顺序进行。这是为了消除未知的“噪音”因素（如环境温度变化、仪器漂移）对结果的系统性影响。

**步骤 4：执行试验并记录数据**

按照随机化后的顺序进行每次试验，并准确记录每次试验的产率（响应值）Y。

# Plackett-Burman的原理是什么？

PB设计的原理基于两个核心概念：**主效应** 和 **别名结构**。

## 主效应

一个因素的“主效应”是指该因素从低水平（-1）变为高水平（+1）时，所引起的响应变量（如产率）的平均变化量。
*   计算方式：$效应 = (所有高水平下响应的平均值) - (所有低水平下响应的平均值)$

## 别名结构（关键原理）

PB设计之所以能用少量试验评估多个因素，是因为它**牺牲了交互效应的可估性**。

* **全因子设计**：可以独立地估计所有主效应和所有交互效应（如A×B）。
* **PB设计**：试验次数大大减少，导致主效应和某些高阶交互效应（通常是二阶或三阶交互效应）**完全混杂**在一起。这意味着，我们从数据分析中计算出的“A的效应”，实际上可能是“A的主效应 + BCD的交互效应 + ...”。

## 核心假设（效应稀疏性原则）

在众多因素中，只有少数几个是活跃的（效应显著不为零），而大部分因素是不活跃的（效应接近零）。同时，交互效应通常比主效应要小。

基于这个假设，如果一个因素被计算出的“效应”很大，我们倾向于认为这个巨大的效应主要来自于它本身的主效应，而不是与它混杂的那些（很可能不活跃的）因素的交互效应。因为如果交互效应要很大，需要多个因素同时都是活跃的，这在“效应稀疏”的系统中概率较低。

## 总结原理

PB设计通过巧妙地安排试验组合，使得主效应与高阶交互效应相混杂。在“效应稀疏”的假设下，我们可以将计算出的较大效应归因于相应因素的主效应，从而高效地完成因子筛选。

---

# 如何分析Plackett-Burman试验的结果？

分析通常结合图形化和数值化方法。

**步骤 1：计算每个因素的主效应**

根据上面的公式，计算A, B, C, ... G 这7个因素各自的效应值。

**步骤 2：正态概率图（最常用、最直观的方法）**

这是筛选设计的**标准分析工具**。

* **做法**：将计算出的7个效应值从小到大画在一张“正态概率纸”上（统计软件可自动完成）。
* **解读**：
    *   **不活跃的因素**：它们的效应应该很小，只是由随机误差引起的。这些点会大致分布在一条直线上。
    *   **活跃的因素**：它们的真实效应显著不为零，因此它们的点会明显偏离那条由不活跃因素构成的直线。
* **结果**：在图上，你会看到大部分点形成一条直线，而一两个点远离这条直线。这些远离直线的点对应的因素，就是被筛选出的**显著因素**。

**步骤 3：半正态概率图**

与正态概率图类似，也是将效应的绝对值从小到大画在半正态概率纸上。解读方式相同：偏离直线的点对应的因素是显著的。

**步骤 4：方差分析（ANOVA）**

虽然PB设计是非饱和的（有空列估计误差），可以进行ANOVA分析，但在因子筛选阶段，**正态概率图通常比ANOVA更可靠**。因为筛选设计的数据量小，方差估计本身不稳健，ANOVA的结论有时会显得“保守”。不过，ANOVA可以给出p值作为辅助判断。

**步骤 5：解释与后续行动**

* **确定关键因素**：假设通过正态概率图发现因素A（温度）和C（催化剂用量）是显著的。
* **结论**：在后续的工艺优化中，应重点关註因素A和C。而因素B, D, E, F, G相对不重要，可以将它们固定在某个经济或方便的水平上。
* **下一步**：基于筛选出的关键因素（A和C），可以设计更精细的试验（如全因子设计或中心复合设计）来研究它们的主效应以及它们之间可能存在的交互效应（A×C），并最终找到使产率最高的最优参数组合。

# 注意事项

*   **不要用PB设计来寻找最优参数**：PB设计的目的是“筛选”，而不是“优化”。它只能告诉你哪些因素重要，不能精确告诉你参数设在什么水平最好。
*   **注意混杂**：始终要记住，PB设计中主效应与交互效应是混杂的。当筛选出的因素进入优化阶段后，需要仔细研究其交互作用。
*   **水平选择**：高、低两个水平的选择至关重要，它们应该有足够的差异，以便能检测到真实的效应，但又不能大到不切实际或导致实验失败。